import{d as R}from"./chunk-WR7XAGZW.js";import{Wb as F,Xb as U}from"./chunk-FLFKSUZI.js";import{b as j,c as q,f as $,i as G,j as W,k as B,m as H}from"./chunk-SL2VEL43.js";import{Ac as P,Bb as s,Dc as O,Ib as N,Jc as L,Mb as o,Na as d,Nb as x,Ob as h,Rb as y,Sb as D,T as E,Tb as C,Y as v,Zb as S,_b as M,ab as w,ac as V,ca as m,da as u,eb as b,pb as p,qb as t,rb as i,sb as g,vc as A,wc as T,xc as k,yb as f,zb as _}from"./chunk-IVDQKAZB.js";var I=class a{http=v(L);apiUrl="/api/documents";getByNpa(n){return this.http.get(`${this.apiUrl}/npas/${n}`)}getRequirementsMatrix(n){return this.http.get(`${this.apiUrl}/npas/${n}/requirements`)}upload(n,e,r){let l=new FormData;return l.append("file",e),r.document_type&&l.append("document_type",r.document_type),r.category&&l.append("category",r.category),r.uploaded_by&&l.append("uploaded_by",r.uploaded_by),this.http.post(`${this.apiUrl}/npas/${n}/upload`,l)}validate(n,e){return this.http.put(`${this.apiUrl}/${n}/validate`,e)}delete(n){return this.http.delete(`${this.apiUrl}/${n}`)}static \u0275fac=function(e){return new(e||a)};static \u0275prov=E({token:a,factory:a.\u0275fac,providedIn:"root"})};var J=(a,n,e,r)=>({"bg-green-50 text-green-700 border-green-200":a,"bg-amber-50 text-amber-700 border-amber-200":n,"bg-red-50 text-red-700 border-red-200":e,"bg-yellow-50 text-yellow-700 border-yellow-200":r}),Q=(a,n,e,r)=>({"bg-green-500":a,"bg-amber-500":n,"bg-red-500":e,"bg-yellow-500":r});function X(a,n){a&1&&(t(0,"span",35),o(1," Uploading... "),i())}function Y(a,n){if(a&1){let e=f();t(0,"div",22)(1,"input",23,0),_("change",function(l){m(e);let c=s();return u(c.onFileSelected(l))}),i(),t(3,"button",24),_("click",function(){m(e);let l=N(2);return u(l.click())}),g(4,"lucide-icon",25),o(5," Upload Document "),i(),t(6,"select",26),C("ngModelChange",function(l){m(e);let c=s();return D(c.uploadDocType,l)||(c.uploadDocType=l),u(l)}),t(7,"option",27),o(8,"Type: Other"),i(),t(9,"option",28),o(10,"Term Sheet"),i(),t(11,"option",29),o(12,"Risk Assessment"),i(),t(13,"option",30),o(14,"Legal Opinion"),i(),t(15,"option",31),o(16,"Pricing Model"),i(),t(17,"option",32),o(18,"PAC Submission"),i(),t(19,"option",33),o(20,"Compliance Clearance"),i()(),b(21,X,2,0,"span",34),i()}if(a&2){let e=s();d(6),y("ngModel",e.uploadDocType),d(15),p("ngIf",e.uploadProgress)}}function Z(a,n){if(a&1){let e=f();t(0,"div",36),o(1," Select an NPA to manage documents. "),t(2,"input",37),C("ngModelChange",function(l){m(e);let c=s();return D(c.npaIdInput,l)||(c.npaIdInput=l),u(l)}),i(),t(3,"button",38),_("click",function(){m(e);let l=s();return u(l.loadNpa())}),o(4,"Load"),i()()}if(a&2){let e=s();d(2),y("ngModel",e.npaIdInput)}}function ee(a,n){if(a&1){let e=f();t(0,"button",56),_("click",function(){m(e);let l=s().$implicit,c=s();return u(c.validateDoc(l,"VALID"))}),g(1,"lucide-icon",57),i()}}function te(a,n){if(a&1){let e=f();t(0,"button",58),_("click",function(){m(e);let l=s().$implicit,c=s();return u(c.validateDoc(l,"INVALID"))}),g(1,"lucide-icon",59),i()}}function ne(a,n){if(a&1){let e=f();t(0,"tr",39)(1,"td",40)(2,"div",6)(3,"div",41),o(4),i(),t(5,"div")(6,"div",42),o(7),i(),t(8,"div",43),o(9),i()()()(),t(10,"td",40)(11,"span",44),o(12),i()(),t(13,"td",45),o(14),i(),t(15,"td",46)(16,"span",47),g(17,"span",48),o(18),i()(),t(19,"td",40)(20,"div",49),o(21),i(),t(22,"div",50),o(23),M(24,"date"),i()(),t(25,"td",46)(26,"div",51),b(27,ee,2,0,"button",52)(28,te,2,0,"button",53),t(29,"button",54),_("click",function(){let l=m(e).$implicit,c=s();return u(c.deleteDoc(l))}),g(30,"lucide-icon",55),i()()()()}if(a&2){let e=n.$implicit,r=s();d(3),p("ngClass",r.getFileIconClass(e.file_extension)),d(),h(" ",(e.file_extension||"").replace(".","").toUpperCase()||"?"," "),d(3),x(e.document_name),d(2),x(e.category||"Uncategorized"),d(3),x(e.document_type),d(2),x(e.file_size),d(2),p("ngClass",S(16,J,e.validation_status==="VALID",e.validation_status==="PENDING",e.validation_status==="INVALID",e.validation_status==="WARNING")),d(),p("ngClass",S(21,Q,e.validation_status==="VALID",e.validation_status==="PENDING",e.validation_status==="INVALID",e.validation_status==="WARNING")),d(),h(" ",e.validation_status," "),d(3),x(e.uploaded_by),d(2),x(V(24,13,e.uploaded_at,"short")),d(4),p("ngIf",e.validation_status==="PENDING"),d(),p("ngIf",e.validation_status==="PENDING")}}function ie(a,n){if(a&1&&(t(0,"div",60),g(1,"lucide-icon",61),t(2,"h3",62),o(3,"No documents yet"),i(),t(4,"p",63),o(5),i()()),a&2){let e=s();d(5),x(e.npaId?"Upload documents for this NPA.":"Enter an NPA ID to get started.")}}var z=class a{docService=v(I);route=v(R);npaId="";npaIdInput="";documents=[];uploadDocType="OTHER";uploadProgress=!1;ngOnInit(){this.route.queryParams.subscribe(n=>{n.npaId&&(this.npaId=n.npaId,this.loadDocuments())})}loadNpa(){this.npaIdInput&&(this.npaId=this.npaIdInput,this.loadDocuments())}loadDocuments(){this.npaId&&this.docService.getByNpa(this.npaId).subscribe({next:n=>this.documents=n,error:n=>console.error("[DOCS] Load failed",n)})}onFileSelected(n){let e=n.target,r=e.files?.[0];!r||!this.npaId||(this.uploadProgress=!0,this.docService.upload(this.npaId,r,{document_type:this.uploadDocType,uploaded_by:"user"}).subscribe({next:()=>{this.uploadProgress=!1,this.loadDocuments(),e.value=""},error:l=>{this.uploadProgress=!1,alert(l.error?.error||"Upload failed")}}))}validateDoc(n,e){this.docService.validate(n.id,{validation_status:e}).subscribe({next:()=>this.loadDocuments(),error:r=>alert(r.error?.error||"Validation update failed")})}deleteDoc(n){confirm(`Delete "${n.document_name}"?`)&&this.docService.delete(n.id).subscribe({next:()=>this.loadDocuments(),error:e=>alert(e.error?.error||"Delete failed")})}getFileIconClass(n){let e=(n||"").toLowerCase();return e.includes("pdf")?"bg-red-50 text-red-600 border border-red-100":e.includes("doc")?"bg-blue-50 text-blue-600 border border-blue-100":e.includes("xls")?"bg-green-50 text-green-600 border border-green-100":e.includes("ppt")?"bg-orange-50 text-orange-600 border border-orange-100":e.includes("png")||e.includes("jpg")||e.includes("jpeg")?"bg-purple-50 text-purple-600 border border-purple-100":"bg-slate-50 text-slate-600 border border-slate-100"}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=w({type:a,selectors:[["app-document-manager"]],decls:36,vars:6,consts:[["fileInput",""],[1,"h-full","flex","flex-col","bg-slate-50","font-sans","text-slate-900"],[1,"flex-none","bg-white","border-b","border-slate-200","px-8","py-5","flex","items-center","justify-between","shadow-sm"],[1,"text-2xl","font-bold","text-slate-900","tracking-tight","flex","items-center","gap-3"],["name","file-stack",1,"w-6","h-6","text-blue-600"],[1,"text-sm","text-slate-500","mt-1"],[1,"flex","items-center","gap-3"],[1,"bg-blue-50","text-blue-700","px-3","py-1","rounded-full","text-xs","font-bold","border","border-blue-100"],[1,"flex-none","bg-white","border-b","border-slate-200","px-8","py-4"],[1,"flex","items-center","gap-4"],["class","flex-1 flex items-center gap-3",4,"ngIf"],["class","text-sm text-slate-500",4,"ngIf"],[1,"flex-1","overflow-auto","p-8"],[1,"max-w-5xl","mx-auto"],[1,"bg-white","rounded-xl","border","border-slate-200","shadow-sm","overflow-hidden"],[1,"w-full","text-left","text-xs"],[1,"bg-slate-50","border-b","border-slate-200","text-slate-500","uppercase","tracking-wider","font-semibold"],[1,"px-6","py-3"],[1,"px-6","py-3","text-center"],[1,"divide-y","divide-slate-100"],["class","hover:bg-slate-50 transition-colors",4,"ngFor","ngForOf"],["class","text-center py-20",4,"ngIf"],[1,"flex-1","flex","items-center","gap-3"],["type","file","accept",".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.csv,.json,.png,.jpg,.jpeg",1,"hidden",3,"change"],[1,"px-4","py-2","bg-dbs-primary","text-white","rounded-lg","text-sm","font-semibold","hover:bg-dbs-primary-hover","transition-colors","flex","items-center","gap-2",3,"click"],["name","upload-cloud",1,"w-4","h-4"],[1,"px-3","py-2","border","border-slate-200","rounded-lg","text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-200",3,"ngModelChange","ngModel"],["value","OTHER"],["value","TERM_SHEET"],["value","RISK_ASSESSMENT"],["value","LEGAL_OPINION"],["value","PRICING_MODEL"],["value","PAC_SUBMISSION"],["value","COMPLIANCE_CLEARANCE"],["class","text-sm text-blue-600 font-medium animate-pulse",4,"ngIf"],[1,"text-sm","text-blue-600","font-medium","animate-pulse"],[1,"text-sm","text-slate-500"],["placeholder","Enter NPA ID (e.g. NPA-001)",1,"ml-3","px-3","py-1.5","border","border-slate-200","rounded-lg","text-sm","w-48",3,"ngModelChange","ngModel"],[1,"ml-2","px-3","py-1.5","bg-dbs-primary","text-white","rounded-lg","text-xs","font-semibold","hover:bg-dbs-primary-hover","transition-colors",3,"click"],[1,"hover:bg-slate-50","transition-colors"],[1,"px-6","py-4"],[1,"w-8","h-8","rounded","flex","items-center","justify-center","text-[10px]","font-bold",3,"ngClass"],[1,"font-bold","text-slate-900","text-sm"],[1,"text-[10px]","text-slate-400","mt-0.5"],[1,"px-2","py-0.5","rounded","text-[10px]","font-bold","bg-slate-100","text-slate-600","border","border-slate-200"],[1,"px-6","py-4","text-slate-500","font-mono","text-[11px]"],[1,"px-6","py-4","text-center"],[1,"inline-flex","items-center","gap-1","px-2","py-0.5","rounded-full","text-[10px]","font-bold","border",3,"ngClass"],[1,"w-1.5","h-1.5","rounded-full",3,"ngClass"],[1,"text-slate-600","text-[11px]"],[1,"text-slate-400","text-[10px]"],[1,"flex","items-center","justify-center","gap-1"],["class","p-1.5 hover:bg-green-50 rounded text-green-600","title","Mark Valid",3,"click",4,"ngIf"],["class","p-1.5 hover:bg-red-50 rounded text-red-600","title","Mark Invalid",3,"click",4,"ngIf"],["title","Delete",1,"p-1.5","hover:bg-slate-100","rounded","text-slate-400",3,"click"],["name","trash-2",1,"w-3.5","h-3.5"],["title","Mark Valid",1,"p-1.5","hover:bg-green-50","rounded","text-green-600",3,"click"],["name","check",1,"w-3.5","h-3.5"],["title","Mark Invalid",1,"p-1.5","hover:bg-red-50","rounded","text-red-600",3,"click"],["name","x",1,"w-3.5","h-3.5"],[1,"text-center","py-20"],["name","file-plus",1,"w-12","h-12","text-slate-300","mx-auto","mb-4"],[1,"text-lg","font-medium","text-slate-900"],[1,"text-slate-500","mt-2"]],template:function(e,r){e&1&&(t(0,"div",1)(1,"div",2)(2,"div")(3,"h1",3),g(4,"lucide-icon",4),o(5," Document Manager "),i(),t(6,"p",5),o(7),i()(),t(8,"div",6)(9,"div",7),o(10),i()()(),t(11,"div",8)(12,"div",9),b(13,Y,22,2,"div",10)(14,Z,5,1,"div",11),i()(),t(15,"div",12)(16,"div",13)(17,"div",14)(18,"table",15)(19,"thead",16)(20,"tr")(21,"th",17),o(22,"Document"),i(),t(23,"th",17),o(24,"Type"),i(),t(25,"th",17),o(26,"Size"),i(),t(27,"th",18),o(28,"Validation"),i(),t(29,"th",17),o(30,"Uploaded"),i(),t(31,"th",18),o(32,"Actions"),i()()(),t(33,"tbody",19),b(34,ne,31,26,"tr",20),i()(),b(35,ie,6,1,"div",21),i()()()()),e&2&&(d(7),h(" ",r.npaId?"Documents for NPA "+r.npaId:"Upload and manage NPA documents."," "),d(3),h(" ",r.documents.length," Documents "),d(3),p("ngIf",r.npaId),d(),p("ngIf",!r.npaId),d(20),p("ngForOf",r.documents),d(),p("ngIf",r.documents.length===0))},dependencies:[O,A,T,k,U,F,H,W,B,j,G,q,$,P],styles:["[_nghost-%COMP%]{display:block;height:100%}"]})};export{z as a};
