import{a as V}from"./chunk-IUB5JG3Z.js";import{Wb as M,Xb as T}from"./chunk-FLFKSUZI.js";import{c as O,f as U,i as D,j,k as G,m as W}from"./chunk-SL2VEL43.js";import{Bb as v,Dc as P,Jc as F,Mb as a,Na as r,Nb as g,Ob as _,Pb as f,Rb as h,Sb as y,T as C,Tb as A,Y as c,Yb as I,ab as N,ca as S,da as w,eb as p,pb as o,qb as i,rb as n,sb as m,vc as E,wc as k,xc as L,yb as B,zb as b}from"./chunk-IVDQKAZB.js";var x=class s{http=c(F);apiUrl="/api/bundling";assess(t,e){return this.http.get(`${this.apiUrl}/${t}/assess?parent_id=${e}`)}apply(t,e){return this.http.post(`${this.apiUrl}/${t}/apply`,{parent_id:e})}static \u0275fac=function(e){return new(e||s)};static \u0275prov=C({token:s,factory:s.\u0275fac,providedIn:"root"})};var H=(s,t,e)=>({"bg-green-50 border-green-300":s,"bg-amber-50 border-amber-300":t,"bg-red-50 border-red-300":e}),z=(s,t,e)=>({"bg-green-100 text-green-700":s,"bg-amber-100 text-amber-700":t,"bg-red-100 text-red-700":e});function q(s,t){if(s&1&&(i(0,"option",18),a(1),n()),s&2){let e=t.$implicit;o("value",e.id),r(),f("",e.id," - ",e.title)}}function J(s,t){if(s&1&&(i(0,"option",18),a(1),n()),s&2){let e=t.$implicit;o("value",e.id),r(),f("",e.id," - ",e.title)}}function K(s,t){if(s&1&&(i(0,"div",34)(1,"div",35)(2,"div",36),m(3,"lucide-icon",37),n()(),i(4,"div",38)(5,"div",39),a(6),n(),i(7,"div",40),a(8),n()(),i(9,"span",41),a(10),n()()),s&2){let e=t.$implicit;r(2),o("ngClass",e.passed?"bg-green-100 text-green-600":"bg-red-100 text-red-600"),r(),o("name",e.passed?"check":"x"),r(3),g(e.condition),r(2),g(e.detail),r(),o("ngClass",e.passed?"bg-green-50 text-green-700":"bg-red-50 text-red-700"),r(),_(" ",e.passed?"PASS":"FAIL"," ")}}function Q(s,t){if(s&1){let e=B();i(0,"div",42)(1,"button",43),b("click",function(){S(e);let u=v(2);return w(u.applyBundling())}),m(2,"lucide-icon",44),a(3," Apply Bundling Track "),n()()}}function X(s,t){if(s&1&&(i(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",22),m(4,"lucide-icon",23),n(),i(5,"div")(6,"div",24),a(7," Recommended: "),i(8,"span",25),a(9),n()(),i(10,"p",26),a(11),n(),i(12,"p",27),a(13),n()()()(),i(14,"div",28)(15,"div",29)(16,"h3",30),a(17,"Condition Details"),n()(),i(18,"div",31),p(19,K,11,6,"div",32),n()(),p(20,Q,4,0,"div",33),n()),s&2){let e=v();r(),o("ngClass",I(9,H,e.assessment.recommended_track==="BUNDLING",e.assessment.recommended_track==="NPA_LITE",e.assessment.recommended_track==="FULL_NPA")),r(2),o("ngClass",I(13,z,e.assessment.recommended_track==="BUNDLING",e.assessment.recommended_track==="NPA_LITE",e.assessment.recommended_track==="FULL_NPA")),r(),o("name",e.assessment.recommended_track==="BUNDLING"?"check-circle":e.assessment.recommended_track==="NPA_LITE"?"alert-circle":"x-circle"),r(5),g(e.assessment.recommended_track.replace("_"," ")),r(2),g(e.assessment.recommendation_reason),r(2),f("",e.assessment.passed_count,"/",e.assessment.total_conditions," conditions passed"),r(6),o("ngForOf",e.assessment.conditions),r(),o("ngIf",e.assessment.recommended_track==="BUNDLING")}}var $=class s{bundlingService=c(x);npaService=c(V);npaList=[];approvedList=[];childId="";parentId="";loading=!1;assessment=null;constructor(){this.npaService.getAll().subscribe({next:t=>{this.npaList=t,this.approvedList=t.filter(e=>e.current_stage==="LAUNCHED"||e.current_stage==="APPROVED")}})}runAssessment(){!this.childId||!this.parentId||(this.loading=!0,this.assessment=null,this.bundlingService.assess(this.childId,this.parentId).subscribe({next:t=>{this.assessment=t,this.loading=!1},error:t=>{alert(t.error?.error||"Assessment failed"),this.loading=!1}}))}applyBundling(){!this.assessment||!confirm("Apply BUNDLING track to this NPA?")||this.bundlingService.apply(this.childId,this.parentId).subscribe({next:()=>alert("Bundling track applied successfully!"),error:t=>alert(t.error?.error||"Apply failed")})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=N({type:s,selectors:[["app-bundling-assessment"]],decls:32,vars:7,consts:[[1,"h-full","flex","flex-col","bg-slate-50","font-sans","text-slate-900"],[1,"flex-none","bg-white","border-b","border-slate-200","px-8","py-5","shadow-sm"],[1,"text-2xl","font-bold","text-slate-900","tracking-tight","flex","items-center","gap-3"],["name","package",1,"w-6","h-6","text-blue-600"],[1,"text-sm","text-slate-500","mt-1"],[1,"flex-1","overflow-auto","p-8"],[1,"max-w-3xl","mx-auto","space-y-8"],[1,"bg-white","rounded-xl","border","border-slate-200","shadow-sm","p-6","space-y-4"],[1,"text-sm","font-bold","text-slate-900","uppercase","tracking-wider","flex","items-center","gap-2"],["name","search",1,"w-4","h-4","text-slate-400"],[1,"grid","grid-cols-2","gap-4"],[1,"block","text-xs","font-bold","text-slate-500","uppercase","mb-1.5"],[1,"w-full","px-3","py-2","border","border-slate-200","rounded-lg","text-sm","focus:outline-none","focus:ring-2","focus:ring-blue-200",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"px-6","py-2.5","bg-dbs-primary","text-white","rounded-lg","text-sm","font-semibold","hover:bg-dbs-primary-hover","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-2",3,"click","disabled"],["name","zap",1,"w-4","h-4"],["class","space-y-6",4,"ngIf"],[3,"value"],[1,"space-y-6"],[1,"rounded-xl","border-2","p-6",3,"ngClass"],[1,"flex","items-center","gap-4"],[1,"w-14","h-14","rounded-xl","flex","items-center","justify-center",3,"ngClass"],[1,"w-7","h-7",3,"name"],[1,"text-lg","font-bold"],[1,"uppercase"],[1,"text-sm","mt-0.5","opacity-80"],[1,"text-xs","mt-1","opacity-60"],[1,"bg-white","rounded-xl","border","border-slate-200","shadow-sm","overflow-hidden"],[1,"px-6","py-4","border-b","border-slate-200"],[1,"text-sm","font-bold","text-slate-900"],[1,"divide-y","divide-slate-100"],["class","px-6 py-4 flex items-start gap-4",4,"ngFor","ngForOf"],["class","flex justify-end",4,"ngIf"],[1,"px-6","py-4","flex","items-start","gap-4"],[1,"flex-none","pt-0.5"],[1,"w-6","h-6","rounded-full","flex","items-center","justify-center",3,"ngClass"],[1,"w-3.5","h-3.5",3,"name"],[1,"flex-1"],[1,"text-sm","font-semibold","text-slate-900"],[1,"text-xs","text-slate-500","mt-0.5"],[1,"flex-none","px-2","py-0.5","rounded","text-[10px]","font-bold","uppercase",3,"ngClass"],[1,"flex","justify-end"],[1,"px-6","py-2.5","bg-green-600","text-white","rounded-lg","text-sm","font-semibold","hover:bg-green-700","transition-colors","flex","items-center","gap-2",3,"click"],["name","check-circle",1,"w-4","h-4"]],template:function(e,l){e&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2),m(3,"lucide-icon",3),a(4," Bundling Assessment "),n(),i(5,"p",4),a(6,"Evaluate whether a new product can be bundled under an existing approved product."),n()(),i(7,"div",5)(8,"div",6)(9,"div",7)(10,"h2",8),m(11,"lucide-icon",9),a(12," Assess Bundling Eligibility "),n(),i(13,"div",10)(14,"div")(15,"label",11),a(16,"Child NPA (New Product)"),n(),i(17,"select",12),A("ngModelChange",function(d){return y(l.childId,d)||(l.childId=d),d}),i(18,"option",13),a(19,"Select NPA..."),n(),p(20,q,2,3,"option",14),n()(),i(21,"div")(22,"label",11),a(23,"Parent NPA (Approved Product)"),n(),i(24,"select",12),A("ngModelChange",function(d){return y(l.parentId,d)||(l.parentId=d),d}),i(25,"option",13),a(26,"Select Parent..."),n(),p(27,J,2,3,"option",14),n()()(),i(28,"button",15),b("click",function(){return l.runAssessment()}),m(29,"lucide-icon",16),a(30),n()(),p(31,X,21,17,"div",17),n()()()),e&2&&(r(17),h("ngModel",l.childId),r(3),o("ngForOf",l.npaList),r(4),h("ngModel",l.parentId),r(3),o("ngForOf",l.approvedList),r(),o("disabled",!l.childId||!l.parentId||l.loading),r(2),_(" ",l.loading?"Evaluating...":"Run 8-Condition Assessment"," "),r(),o("ngIf",l.assessment))},dependencies:[P,E,k,L,T,M,W,j,G,D,O,U],styles:["[_nghost-%COMP%]{display:block;height:100%}"]})};export{$ as a};
