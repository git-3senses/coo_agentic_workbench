<div class="fixed inset-0 z-[110] flex flex-col h-screen w-screen bg-white font-sans">

  <!-- Header -->
  <app-draft-builder-header
    [projectId]="projectId"
    [progress]="getDraftProgress()"
    [issueCount]="getDraftIssues().length"
    [autoSaveStatus]="autoSaveStatus"
    (closed)="closed.emit()"
    (saved)="autoSaveStatus = 'saving'">
  </app-draft-builder-header>

  <!-- Body â€” 3-column layout -->
  <div class="flex-1 flex overflow-hidden">

    <!-- LEFT: Section Nav (w-60) -->
    <nav class="flex-none w-60 border-r border-slate-100">
      <app-draft-section-nav
        [sections]="sections"
        [activeSectionIndex]="activeSectionIndex"
        (sectionSelected)="setSection($event)">
      </app-draft-section-nav>
    </nav>

    <!-- CENTER: Form -->
    <app-draft-builder-form
      [section]="activeSection"
      [sectionIndex]="activeSectionIndex"
      [totalSections]="sections.length"
      [comments]="comments"
      (navigatePrev)="prevSection()"
      (navigateNext)="nextSection()"
      (valueChanged)="markUnsaved()"
      (commentAdded)="commentAdded.emit($event)"
      (commentResolved)="commentResolved.emit($event)">
    </app-draft-builder-form>

    <!-- RIGHT: Agent Panel -->
    <app-draft-agent-panel
      [isOpen]="agentPanelOpen"
      [messages]="agentMessages"
      [issues]="getDraftIssues()"
      [selectedRefNPA]="selectedRefNPA"
      (togglePanel)="toggleAgentPanel()"
      (messageSent)="onAgentMessageSent($event)"
      (jumpToField)="jumpToField($event)">
    </app-draft-agent-panel>

  </div>
</div>
