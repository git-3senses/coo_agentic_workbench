import{Jc as c,T as n,Y as o,o as a}from"./chunk-IVDQKAZB.js";var l=class r{http=o(c);apiUrl="/api/governance";constructor(){}createProject(e,t){return this.http.post(`${this.apiUrl}/projects`,{title:e,description:t})}analyzeReadiness(e,t){return t?this.http.get(`${this.apiUrl}/readiness/${t}`).pipe(a(i=>this.mapDbReadinessToResult(i))):this.http.post(`${this.apiUrl}/readiness`,{description:e,domain:"ALL"}).pipe(a(i=>this.mapDbReadinessToResult(i)))}saveReadinessAssessment(e,t){return this.http.post(`${this.apiUrl}/readiness`,{projectId:e,domain:"ALL",status:t.isReady?"PASS":"FAIL",score:t.score,findings:t.domains.map(i=>({domain:i.name,status:i.status,observation:i.observation}))})}analyzeClassification(e,t="SG",i){return i?this.http.get(`${this.apiUrl}/classification/${i}`).pipe(a(s=>this.mapDbClassificationToResult(s))):this.http.post(`${this.apiUrl}/classification`,{description:e,jurisdiction:t}).pipe(a(s=>this.mapDbClassificationToResult(s)))}saveClassification(e,t){return this.http.post(`${this.apiUrl}/classification`,{projectId:e,totalScore:t.score||0,calculatedTier:t.tier,breakdown:t.breakdown||{},overrideReason:null})}getProjects(){return this.http.get(`${this.apiUrl}/projects`)}getProjectDetails(e){return this.http.get(`${this.apiUrl}/projects/${e}`)}getDocRules(){return this.http.get(`${this.apiUrl}/doc-rules`)}mapDbReadinessToResult(e){if(e.domains)return e;let t=(e.assessments||e.findings||[]).map(s=>({name:s.domain||s.category_name||s.name,id:s.category_code||s.id,status:s.status||"PENDING",observation:s.observation||s.evidence||"",score:s.score||0,weight:s.weight||0})),i=e.score||e.readiness_score||0;return{isReady:i>=85,score:i,domains:t,overallAssessment:i>=85?"Project appears ready for initiation.":"Critical gaps detected. Please address before proceeding."}}mapDbClassificationToResult(e){if(e.tier)return e;let t=e.calculated_tier||e.calculatedTier||"Existing",i=e.total_score||e.totalScore||0,s="LOW";return t==="New-to-Group"?s="HIGH":t==="Variation"&&(s="MEDIUM"),{tier:t,reason:e.override_reason||"Classification from DB scorecard.",requiredApprovers:e.required_approvers||[],riskLevel:s,score:i,breakdown:e.breakdown||{}}}static \u0275fac=function(t){return new(t||r)};static \u0275prov=n({token:r,factory:r.\u0275fac,providedIn:"root"})};export{l as a};
