import{Wb as U,Xb as R}from"./chunk-FLFKSUZI.js";import{m as V}from"./chunk-SL2VEL43.js";import{Ac as T,Bb as m,Dc as k,Jc as N,Mb as r,Na as o,Nb as p,Ob as c,T as I,Y as g,Yb as P,Zb as E,_b as S,ab as C,ac as w,ca as f,da as _,eb as b,pb as l,qb as i,rb as n,sb as d,vc as D,wc as O,xc as M,yb as v,zb as h}from"./chunk-IVDQKAZB.js";var y=class a{http=g(N);apiUrl="/api/pir";getPending(){return this.http.get(`${this.apiUrl}/pending`)}getDetail(t){return this.http.get(`${this.apiUrl}/${t}`)}submit(t,e){return this.http.post(`${this.apiUrl}/${t}/submit`,e)}approve(t,e){return this.http.post(`${this.apiUrl}/${t}/approve`,e)}extend(t,e){return this.http.post(`${this.apiUrl}/${t}/extend`,e)}static \u0275fac=function(e){return new(e||a)};static \u0275prov=I({token:a,factory:a.\u0275fac,providedIn:"root"})};var L=(a,t,e,s)=>({"bg-red-50 text-red-700 border-red-200":a,"bg-amber-50 text-amber-700 border-amber-200":t,"bg-blue-50 text-blue-700 border-blue-200":e,"bg-green-50 text-green-700 border-green-200":s}),j=(a,t,e,s)=>({"bg-red-500":a,"bg-amber-500":t,"bg-blue-500":e,"bg-green-500":s}),A=(a,t,e)=>({"text-red-600":a,"text-amber-600":t,"text-slate-500":e});function B(a,t){if(a&1&&(i(0,"div",28),r(1),n()),a&2){let e=m();o(),c(" ",e.overdueCount," Overdue ")}}function G(a,t){if(a&1){let e=v();i(0,"button",43),h("click",function(){f(e);let u=m().$implicit,x=m();return _(x.submitPir(u))}),r(1," Submit PIR "),n()}}function H(a,t){if(a&1){let e=v();i(0,"button",44),h("click",function(){f(e);let u=m().$implicit,x=m();return _(x.approvePir(u))}),r(1," Approve "),n()}}function q(a,t){if(a&1){let e=v();i(0,"button",45),h("click",function(){f(e);let u=m().$implicit,x=m();return _(x.extendPir(u))}),r(1," Extend "),n()}}function z(a,t){if(a&1&&(i(0,"tr",29)(1,"td",30)(2,"div",31),r(3),n(),i(4,"div",32),r(5),n()(),i(6,"td",30)(7,"span",33),r(8),n()(),i(9,"td",30)(10,"span",34),d(11,"span",35),r(12),n()(),i(13,"td",36),r(14),S(15,"date"),n(),i(16,"td",37),r(17),n(),i(18,"td",38)(19,"div",39),b(20,G,2,0,"button",40)(21,H,2,0,"button",41)(22,q,2,0,"button",42),n()()()),a&2){let e=t.$implicit;o(3),p(e.title),o(2),p(e.id),o(3),p(e.npa_type),o(2),l("ngClass",E(15,L,e.pir_status==="OVERDUE",e.pir_status==="PENDING",e.pir_status==="SUBMITTED",e.pir_status==="COMPLETED")),o(),l("ngClass",E(20,j,e.pir_status==="OVERDUE",e.pir_status==="PENDING",e.pir_status==="SUBMITTED",e.pir_status==="COMPLETED")),o(),c(" ",e.pir_status," "),o(2),c(" ",w(15,12,e.pir_due_date,"mediumDate")," "),o(2),l("ngClass",P(25,A,e.days_until_due<0,e.days_until_due>=0&&e.days_until_due<=30,e.days_until_due>30)),o(),c(" ",e.days_until_due<0?e.days_until_due+"d":"+"+e.days_until_due+"d"," "),o(3),l("ngIf",e.pir_status==="PENDING"||e.pir_status==="OVERDUE"),o(),l("ngIf",e.pir_status==="SUBMITTED"),o(),l("ngIf",e.pir_status!=="COMPLETED")}}function J(a,t){a&1&&(i(0,"div",46),d(1,"lucide-icon",47),i(2,"h3",48),r(3,"No PIRs pending"),n(),i(4,"p",49),r(5,"All launched products have completed their reviews."),n()())}var $=class a{pirService=g(y);items=[];get overdueCount(){return this.items.filter(t=>t.pir_status==="OVERDUE").length}get dueSoonCount(){return this.items.filter(t=>t.pir_status==="PENDING"&&t.days_until_due<=30&&t.days_until_due>=0).length}get submittedCount(){return this.items.filter(t=>t.pir_status==="SUBMITTED").length}get completedCount(){return this.items.filter(t=>t.pir_status==="COMPLETED").length}ngOnInit(){this.loadData()}loadData(){this.pirService.getPending().subscribe({next:t=>this.items=t,error:t=>console.error("[PIR] Load failed",t)})}submitPir(t){let e=prompt("Enter PIR findings summary:");e&&this.pirService.submit(t.id,{actor_name:"COO",findings:e}).subscribe({next:()=>this.loadData(),error:s=>alert(s.error?.error||"Submit failed")})}approvePir(t){confirm("Approve this PIR? This will mark the review as complete.")&&this.pirService.approve(t.id,{actor_name:"COO"}).subscribe({next:()=>this.loadData(),error:e=>alert(e.error?.error||"Approval failed")})}extendPir(t){let e=prompt("Reason for extension:");if(!e)return;let s=parseInt(prompt("Extend by how many months?","3")||"0",10);s<=0||this.pirService.extend(t.id,{actor_name:"COO",months:s,reason:e}).subscribe({next:()=>this.loadData(),error:u=>alert(u.error?.error||"Extension failed")})}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=C({type:a,selectors:[["app-pir-management"]],decls:59,vars:8,consts:[[1,"h-full","flex","flex-col","bg-slate-50","font-sans","text-slate-900"],[1,"flex-none","bg-white","border-b","border-slate-200","px-8","py-5","flex","items-center","justify-between","shadow-sm"],[1,"text-2xl","font-bold","text-slate-900","tracking-tight","flex","items-center","gap-3"],["name","clipboard-check",1,"w-6","h-6","text-purple-600"],[1,"text-sm","text-slate-500","mt-1"],[1,"flex","items-center","gap-3"],["class","bg-amber-50 text-amber-700 px-3 py-1 rounded-full text-xs font-bold border border-amber-100",4,"ngIf"],[1,"bg-purple-50","text-purple-700","px-3","py-1","rounded-full","text-xs","font-bold","border","border-purple-100"],[1,"flex-none","bg-white","border-b","border-slate-200","px-8","py-4"],[1,"flex","gap-8","text-sm"],[1,"flex","items-center","gap-2"],[1,"w-2.5","h-2.5","rounded-full","bg-red-500"],[1,"text-slate-500"],[1,"font-bold","text-slate-900"],[1,"w-2.5","h-2.5","rounded-full","bg-amber-500"],[1,"w-2.5","h-2.5","rounded-full","bg-blue-500"],[1,"w-2.5","h-2.5","rounded-full","bg-green-500"],[1,"flex-1","overflow-auto","p-8"],[1,"max-w-6xl","mx-auto"],[1,"bg-white","rounded-xl","border","border-slate-200","shadow-sm","overflow-hidden"],[1,"w-full","text-left","text-xs"],[1,"bg-slate-50","border-b","border-slate-200","text-slate-500","uppercase","tracking-wider","font-semibold"],[1,"px-6","py-3"],[1,"px-6","py-3","text-right"],[1,"px-6","py-3","text-center"],[1,"divide-y","divide-slate-100"],["class","hover:bg-slate-50 transition-colors",4,"ngFor","ngForOf"],["class","text-center py-20",4,"ngIf"],[1,"bg-amber-50","text-amber-700","px-3","py-1","rounded-full","text-xs","font-bold","border","border-amber-100"],[1,"hover:bg-slate-50","transition-colors"],[1,"px-6","py-4"],[1,"font-bold","text-slate-900","text-sm"],[1,"text-[10px]","text-slate-400","font-mono","mt-0.5"],[1,"px-2","py-0.5","rounded","text-[10px]","font-bold","uppercase","border","bg-slate-50","text-slate-600","border-slate-200"],[1,"inline-flex","items-center","gap-1.5","px-2","py-1","rounded-full","text-[10px]","font-bold","border",3,"ngClass"],[1,"w-1.5","h-1.5","rounded-full",3,"ngClass"],[1,"px-6","py-4","text-slate-600","font-mono","text-[11px]"],[1,"px-6","py-4","text-right","font-mono","font-medium",3,"ngClass"],[1,"px-6","py-4","text-center"],[1,"flex","items-center","justify-center","gap-2"],["class","px-3 py-1.5 bg-dbs-primary text-white rounded-lg text-xs font-semibold hover:bg-dbs-primary-hover transition-colors",3,"click",4,"ngIf"],["class","px-3 py-1.5 bg-green-600 text-white rounded-lg text-[11px] font-semibold hover:bg-green-700 transition-colors",3,"click",4,"ngIf"],["class","px-3 py-1.5 bg-white text-slate-700 border border-dbs-border rounded-lg text-xs font-semibold hover:bg-slate-50 transition-colors",3,"click",4,"ngIf"],[1,"px-3","py-1.5","bg-dbs-primary","text-white","rounded-lg","text-xs","font-semibold","hover:bg-dbs-primary-hover","transition-colors",3,"click"],[1,"px-3","py-1.5","bg-green-600","text-white","rounded-lg","text-[11px]","font-semibold","hover:bg-green-700","transition-colors",3,"click"],[1,"px-3","py-1.5","bg-white","text-slate-700","border","border-dbs-border","rounded-lg","text-xs","font-semibold","hover:bg-slate-50","transition-colors",3,"click"],[1,"text-center","py-20"],["name","clipboard-check",1,"w-12","h-12","text-slate-300","mx-auto","mb-4"],[1,"text-lg","font-medium","text-slate-900"],[1,"text-slate-500","mt-2"]],template:function(e,s){e&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),d(4,"lucide-icon",3),r(5," Post-Implementation Reviews "),n(),i(6,"p",4),r(7,"Track and manage PIR submissions for launched products."),n()(),i(8,"div",5),b(9,B,2,1,"div",6),i(10,"div",7),r(11),n()()(),i(12,"div",8)(13,"div",9)(14,"div",10),d(15,"div",11),i(16,"span",12),r(17,"Overdue:"),n(),i(18,"span",13),r(19),n()(),i(20,"div",10),d(21,"div",14),i(22,"span",12),r(23,"Due < 30d:"),n(),i(24,"span",13),r(25),n()(),i(26,"div",10),d(27,"div",15),i(28,"span",12),r(29,"Submitted:"),n(),i(30,"span",13),r(31),n()(),i(32,"div",10),d(33,"div",16),i(34,"span",12),r(35,"Completed:"),n(),i(36,"span",13),r(37),n()()()(),i(38,"div",17)(39,"div",18)(40,"div",19)(41,"table",20)(42,"thead",21)(43,"tr")(44,"th",22),r(45,"Product"),n(),i(46,"th",22),r(47,"Type"),n(),i(48,"th",22),r(49,"PIR Status"),n(),i(50,"th",22),r(51,"Due Date"),n(),i(52,"th",23),r(53,"Days Left"),n(),i(54,"th",24),r(55,"Actions"),n()()(),i(56,"tbody",25),b(57,z,23,29,"tr",26),n()(),b(58,J,6,0,"div",27),n()()()()),e&2&&(o(9),l("ngIf",s.overdueCount>0),o(2),c(" ",s.items.length," Pending "),o(8),p(s.overdueCount),o(6),p(s.dueSoonCount),o(6),p(s.submittedCount),o(6),p(s.completedCount),o(20),l("ngForOf",s.items),o(),l("ngIf",s.items.length===0))},dependencies:[k,D,O,M,R,U,V,T],styles:["[_nghost-%COMP%]{display:block;height:100%}"]})};export{$ as a};
