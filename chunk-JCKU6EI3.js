import{F as K}from"./chunk-KLMCEAWT.js";import{D as v,H as L,J as q,K as N,y as $}from"./chunk-O4ZFC2O5.js";import{b as m,d as S,j as k}from"./chunk-3XTWLQCQ.js";import{b as D}from"./chunk-OD4VSVIC.js";import{a as g,b as y}from"./chunk-7RJXRMKA.js";function _(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var r=Array.from(typeof t=="string"?[t]:t);r[r.length-1]=r[r.length-1].replace(/\r?\n([\t ]*)$/,"");var e=r.reduce(function(i,l){var c=l.match(/\n([\t ]+|(?!\s).)/g);return c?i.concat(c.map(function(p){var u,f;return(f=(u=p.match(/[\t ]/g))===null||u===void 0?void 0:u.length)!==null&&f!==void 0?f:0})):i},[]);if(e.length){var s=new RegExp(`
[	 ]{`+Math.min.apply(Math,e)+"}","g");r=r.map(function(i){return i.replace(s,`
`)})}r[0]=r[0].replace(/^\r?\n/,"");var a=r[0];return n.forEach(function(i,l){var c=a.match(/(?:^|\n)( *)$/),p=c?c[1]:"",u=i;typeof i=="string"&&i.includes(`
`)&&(u=String(i).split(`
`).map(function(f,h){return h===0?f:""+p+f}).join(`
`)),a+=u+r[l+1]}),a}var ht=Object.freeze({left:0,top:0,width:16,height:16}),w=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),O=Object.freeze(g(g({},ht),w)),Q=Object.freeze(y(g({},O),{body:"",hidden:!1}));var dt=Object.freeze({width:null,height:null}),X=Object.freeze(g(g({},dt),w));var R=(t,n,o,r="")=>{let e=t.split(":");if(t.slice(0,1)==="@"){if(e.length<2||e.length>3)return null;r=e.shift().slice(1)}if(e.length>3||!e.length)return null;if(e.length>1){let i=e.pop(),l=e.pop(),c={provider:e.length>0?e[0]:r,prefix:l,name:i};return n&&!E(c)?null:c}let s=e[0],a=s.split("-");if(a.length>1){let i={provider:r,prefix:a.shift(),name:a.join("-")};return n&&!E(i)?null:i}if(o&&r===""){let i={provider:r,prefix:"",name:s};return n&&!E(i,o)?null:i}return null},E=(t,n)=>t?!!((n&&t.prefix===""||t.prefix)&&t.name):!1;function Y(t,n){let o={};!t.hFlip!=!n.hFlip&&(o.hFlip=!0),!t.vFlip!=!n.vFlip&&(o.vFlip=!0);let r=((t.rotate||0)+(n.rotate||0))%4;return r&&(o.rotate=r),o}function W(t,n){let o=Y(t,n);for(let r in Q)r in w?r in t&&!(r in o)&&(o[r]=w[r]):r in n?o[r]=n[r]:r in t&&(o[r]=t[r]);return o}function Z(t,n){let o=t.icons,r=t.aliases||Object.create(null),e=Object.create(null);function s(a){if(o[a])return e[a]=[];if(!(a in e)){e[a]=null;let i=r[a]&&r[a].parent,l=i&&s(i);l&&(e[a]=[i].concat(l))}return e[a]}return(n||Object.keys(o).concat(Object.keys(r))).forEach(s),e}function J(t,n,o){let r=t.icons,e=t.aliases||Object.create(null),s={};function a(i){s=W(r[i]||e[i],s)}return a(n),o.forEach(a),W(t,s)}function M(t,n){if(t.icons[n])return J(t,n,[]);let o=Z(t,[n])[n];return o?J(t,n,o):null}var xt=/(-?[0-9.]*[0-9]+[0-9.]*)/g,It=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function V(t,n,o){if(n===1)return t;if(o=o||100,typeof t=="number")return Math.ceil(t*n*o)/o;if(typeof t!="string")return t;let r=t.split(xt);if(r===null||!r.length)return t;let e=[],s=r.shift(),a=It.test(s);for(;;){if(a){let i=parseFloat(s);isNaN(i)?e.push(s):e.push(Math.ceil(i*n*o)/o)}else e.push(s);if(s=r.shift(),s===void 0)return e.join("");a=!a}}function St(t,n="defs"){let o="",r=t.indexOf("<"+n);for(;r>=0;){let e=t.indexOf(">",r),s=t.indexOf("</"+n);if(e===-1||s===-1)break;let a=t.indexOf(">",s);if(a===-1)break;o+=t.slice(e+1,s).trim(),t=t.slice(0,r).trim()+t.slice(a+1)}return{defs:o,content:t}}function wt(t,n){return t?"<defs>"+t+"</defs>"+n:n}function tt(t,n,o){let r=St(t);return wt(r.defs,n+r.content+o)}var Tt=t=>t==="unset"||t==="undefined"||t==="none";function G(t,n){let o=g(g({},O),t),r=g(g({},X),n),e={left:o.left,top:o.top,width:o.width,height:o.height},s=o.body;[o,r].forEach(b=>{let d=[],gt=b.hFlip,H=b.vFlip,I=b.rotate;gt?H?I+=2:(d.push("translate("+(e.width+e.left).toString()+" "+(0-e.top).toString()+")"),d.push("scale(-1 1)"),e.top=e.left=0):H&&(d.push("translate("+(0-e.left).toString()+" "+(e.height+e.top).toString()+")"),d.push("scale(1 -1)"),e.top=e.left=0);let x;switch(I<0&&(I-=Math.floor(I/4)*4),I=I%4,I){case 1:x=e.height/2+e.top,d.unshift("rotate(90 "+x.toString()+" "+x.toString()+")");break;case 2:d.unshift("rotate(180 "+(e.width/2+e.left).toString()+" "+(e.height/2+e.top).toString()+")");break;case 3:x=e.width/2+e.left,d.unshift("rotate(-90 "+x.toString()+" "+x.toString()+")");break}I%2===1&&(e.left!==e.top&&(x=e.left,e.left=e.top,e.top=x),e.width!==e.height&&(x=e.width,e.width=e.height,e.height=x)),d.length&&(s=tt(s,'<g transform="'+d.join(" ")+'">',"</g>"))});let a=r.width,i=r.height,l=e.width,c=e.height,p,u;a===null?(u=i===null?"1em":i==="auto"?c:i,p=V(u,l/c)):(p=a==="auto"?l:a,u=i===null?V(p,c/l):i==="auto"?c:i);let f={},h=(b,d)=>{Tt(d)||(f[b]=d.toString())};h("width",p),h("height",u);let T=[e.left,e.top,l,c];return f.viewBox=T.join(" "),{attributes:f,viewBox:T,body:s}}var bt=/\sid="(\S+)"/g,et=new Map;function yt(t){t=t.replace(/[0-9]+$/,"")||"a";let n=et.get(t)||0;return et.set(t,n+1),n?`${t}${n}`:t}function P(t){let n=[],o;for(;o=bt.exec(t);)n.push(o[1]);if(!n.length)return t;let r="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(e=>{let s=yt(e),a=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");t=t.replace(new RegExp('([#;"])('+a+')([")]|\\.[a-z])',"g"),"$1"+s+r+"$3")}),t=t.replace(new RegExp(r,"g"),""),t}function z(t,n){let o=t.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(let r in n)o+=" "+r+'="'+n[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+o+">"+t+"</svg>"}var vt={body:'<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/><text transform="translate(21.16 64.67)" style="fill: #fff; font-family: ArialMT, Arial; font-size: 67.75px;"><tspan x="0" y="0">?</tspan></text></g>',height:80,width:80},A=new Map,nt=new Map,fe=m(t=>{for(let n of t){if(!n.name)throw new Error('Invalid icon loader. Must have a "name" property with non-empty string value.');if(S.debug("Registering icon pack:",n.name),"loader"in n)nt.set(n.name,n.loader);else if("icons"in n)A.set(n.name,n.icons);else throw S.error("Invalid icon loader:",n),new Error('Invalid icon loader. Must have either "icons" or "loader" property.')}},"registerIconPacks"),ot=m(async(t,n)=>{let o=R(t,!0,n!==void 0);if(!o)throw new Error(`Invalid icon name: ${t}`);let r=o.prefix||n;if(!r)throw new Error(`Icon name must contain a prefix: ${t}`);let e=A.get(r);if(!e){let a=nt.get(r);if(!a)throw new Error(`Icon set not found: ${o.prefix}`);try{let i=await a();e=y(g({},i),{prefix:r}),A.set(r,e)}catch(i){throw S.error(i),new Error(`Failed to load icon set: ${o.prefix}`)}}let s=M(e,o.name);if(!s)throw new Error(`Icon not found: ${t}`);return s},"getRegisteredIconData"),kt=m(async t=>{try{return await ot(t),!0}catch{return!1}},"isIconAvailable"),Et=m(async(t,n,o)=>{let r;try{r=await ot(t,n?.fallbackPrefix)}catch(a){S.error(a),r=vt}let e=G(r,n),s=z(P(e.body),g(g({},e.attributes),o));return v(s,$())},"getIconSVG");function rt(t,{markdownAutoWrap:n}){let r=t.replace(/<br\/>/g,`
`).replace(/\n{2,}/g,`
`),e=_(r);return n===!1?e.replace(/ /g,"&nbsp;"):e}m(rt,"preprocessMarkdown");function it(t,n={}){let o=rt(t,n),r=D.lexer(o),e=[[]],s=0;function a(i,l="normal"){i.type==="text"?i.text.split(`
`).forEach((p,u)=>{u!==0&&(s++,e.push([])),p.split(" ").forEach(f=>{f=f.replace(/&#39;/g,"'"),f&&e[s].push({content:f,type:l})})}):i.type==="strong"||i.type==="em"?i.tokens.forEach(c=>{a(c,i.type)}):i.type==="html"&&e[s].push({content:i.text,type:"normal"})}return m(a,"processNode"),r.forEach(i=>{i.type==="paragraph"?i.tokens?.forEach(l=>{a(l)}):i.type==="html"?e[s].push({content:i.text,type:"normal"}):e[s].push({content:i.raw,type:"normal"})}),e}m(it,"markdownToLines");function st(t,{markdownAutoWrap:n}={}){let o=D.lexer(t);function r(e){return e.type==="text"?n===!1?e.text.replace(/\n */g,"<br/>").replace(/ /g,"&nbsp;"):e.text.replace(/\n */g,"<br/>"):e.type==="strong"?`<strong>${e.tokens?.map(r).join("")}</strong>`:e.type==="em"?`<em>${e.tokens?.map(r).join("")}</em>`:e.type==="paragraph"?`<p>${e.tokens?.map(r).join("")}</p>`:e.type==="space"?"":e.type==="html"?`${e.text}`:e.type==="escape"?e.text:(S.warn(`Unsupported markdown: ${e.type}`),e.raw)}return m(r,"output"),o.map(r).join("")}m(st,"markdownToHTML");function at(t){return Intl.Segmenter?[...new Intl.Segmenter().segment(t)].map(n=>n.segment):[...t]}m(at,"splitTextToChars");function ct(t,n){let o=at(n.content);return U(t,[],o,n.type)}m(ct,"splitWordToFitWidth");function U(t,n,o,r){if(o.length===0)return[{content:n.join(""),type:r},{content:"",type:r}];let[e,...s]=o,a=[...n,e];return t([{content:a.join(""),type:r}])?U(t,a,s,r):(n.length===0&&e&&(n.push(e),o.shift()),[{content:n.join(""),type:r},{content:o.join(""),type:r}])}m(U,"splitWordToFitWidthRecursion");function lt(t,n){if(t.some(({content:o})=>o.includes(`
`)))throw new Error("splitLineToFitWidth does not support newlines in the line");return j(t,n)}m(lt,"splitLineToFitWidth");function j(t,n,o=[],r=[]){if(t.length===0)return r.length>0&&o.push(r),o.length>0?o:[];let e="";t[0].content===" "&&(e=" ",t.shift());let s=t.shift()??{content:" ",type:"normal"},a=[...r];if(e!==""&&a.push({content:e,type:"normal"}),a.push(s),n(a))return j(t,n,o,a);if(r.length>0)o.push(r),t.unshift(s);else if(s.content){let[i,l]=ct(n,s);o.push([i]),l.content&&t.unshift(l)}return j(t,n,o)}m(j,"splitLineToFitWidthRecursion");function B(t,n){n&&t.attr("style",n)}m(B,"applyStyle");async function pt(t,n,o,r,e=!1,s=$()){let a=t.append("foreignObject");a.attr("width",`${10*o}px`),a.attr("height",`${10*o}px`);let i=a.append("xhtml:div"),l=L(n.label)?await q(n.label.replace(N.lineBreakRegex,`
`),s):v(n.label,s),c=n.isNode?"nodeLabel":"edgeLabel",p=i.append("span");p.html(l),B(p,n.labelStyle),p.attr("class",`${c} ${r}`),B(i,n.labelStyle),i.style("display","table-cell"),i.style("white-space","nowrap"),i.style("line-height","1.5"),i.style("max-width",o+"px"),i.style("text-align","center"),i.attr("xmlns","http://www.w3.org/1999/xhtml"),e&&i.attr("class","labelBkg");let u=i.node().getBoundingClientRect();return u.width===o&&(i.style("display","table"),i.style("white-space","break-spaces"),i.style("width",o+"px"),u=i.node().getBoundingClientRect()),a.node()}m(pt,"addHtmlSpan");function F(t,n,o){return t.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",n*o-.1+"em").attr("dy",o+"em")}m(F,"createTspan");function ft(t,n,o){let r=t.append("text"),e=F(r,1,n);C(e,o);let s=e.node().getComputedTextLength();return r.remove(),s}m(ft,"computeWidthOfText");function jt(t,n,o){let r=t.append("text"),e=F(r,1,n);C(e,[{content:o,type:"normal"}]);let s=e.node()?.getBoundingClientRect();return s&&r.remove(),s}m(jt,"computeDimensionOfText");function mt(t,n,o,r=!1){let s=n.append("g"),a=s.insert("rect").attr("class","background").attr("style","stroke: none"),i=s.append("text").attr("y","-10.1"),l=0;for(let c of o){let p=m(f=>ft(s,1.1,f)<=t,"checkWidth"),u=p(c)?[c]:lt(c,p);for(let f of u){let h=F(i,l,1.1);C(h,f),l++}}if(r){let c=i.node().getBBox(),p=2;return a.attr("x",c.x-p).attr("y",c.y-p).attr("width",c.width+2*p).attr("height",c.height+2*p),s.node()}else return i.node()}m(mt,"createFormattedText");function C(t,n){t.text(""),n.forEach((o,r)=>{let e=t.append("tspan").attr("font-style",o.type==="em"?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight",o.type==="strong"?"bold":"normal");r===0?e.text(o.content):e.text(" "+o.content)})}m(C,"updateTextContentAndStyles");async function ut(t,n={}){let o=[];t.replace(/(fa[bklrs]?):fa-([\w-]+)/g,(e,s,a)=>(o.push((async()=>{let i=`${s}:${a}`;return await kt(i)?await Et(i,void 0,{class:"label-icon"}):`<i class='${v(e,n).replace(":"," ")}'></i>`})()),e));let r=await Promise.all(o);return t.replace(/(fa[bklrs]?):fa-([\w-]+)/g,()=>r.shift()??"")}m(ut,"replaceIconSubstring");var he=m(async(t,n="",{style:o="",isTitle:r=!1,classes:e="",useHtmlLabels:s=!0,isNode:a=!0,width:i=200,addSvgBackground:l=!1}={},c)=>{if(S.debug("XYZ createText",n,o,r,e,s,a,"addSvgBackground: ",l),s){let p=st(n,c),u=await ut(K(p),c),f=n.replace(/\\\\/g,"\\"),h={isNode:a,label:L(n)?f:u,labelStyle:o.replace("fill:","color:")};return await pt(t,h,i,e,l,c)}else{let p=n.replace(/<br\s*\/?>/g,"<br/>"),u=it(p.replace("<br>","<br/>"),c),f=mt(i,t,u,n?l:!1);if(a){/stroke:/.exec(o)&&(o=o.replace("stroke:","lineColor:"));let h=o.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");k(f).attr("style",h)}else{let h=o.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/background:/g,"fill:");k(f).select("rect").attr("style",h.replace(/background:/g,"fill:"));let T=o.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");k(f).select("text").attr("style",T)}return f}},"createText");export{_ as a,vt as b,fe as c,Et as d,jt as e,ut as f,he as g};
