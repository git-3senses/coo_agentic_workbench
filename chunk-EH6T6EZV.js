import{Jc as s,T as i,Y as n,o as r}from"./chunk-IVDQKAZB.js";var p=class a{http=n(s);apiUrl="/api/dashboard";getKpis(){return this.http.get(`${this.apiUrl}/kpis`).pipe(r(t=>{if(!Array.isArray(t)){let e=t.snapshot||t;return[{label:"Pipeline Value",value:this.parseNumeric(e.pipeline_value),displayValue:e.pipeline_value,icon:"trending-up"},{label:"Active NPAs",value:this.parseNumeric(e.active_npas),displayValue:""+e.active_npas,icon:"file-text"},{label:"Critical Risks",value:this.parseNumeric(e.critical_risks),displayValue:""+e.critical_risks,icon:"alert-triangle"},{label:"Avg Cycle Days",value:this.parseNumeric(e.avg_cycle_days),displayValue:""+e.avg_cycle_days,icon:"clock"},{label:"Approval Rate",value:this.parseNumeric(e.approval_rate),displayValue:""+e.approval_rate,icon:"check-circle-2"}]}return t.map(e=>({label:e.label,value:this.parseNumeric(e.value),displayValue:e.value,subValue:e.subValue,trend:e.trend,trendUp:e.trendUp,icon:e.icon}))}))}getPipeline(){return this.http.get(`${this.apiUrl}/pipeline`).pipe(r(t=>t.map(e=>({stage:e.stage,count:parseInt(e.count,10)||0,risk_count:parseInt(e.risk_count,10)||0}))))}getClassificationMix(){return this.http.get(`${this.apiUrl}/classification-mix`)}getAgeing(){return this.http.get(`${this.apiUrl}/ageing`).pipe(r(t=>t.map(e=>({bucket:e.bucket||e.label||"",count:parseInt(e.count,10)||0}))))}getClusters(){return this.http.get(`${this.apiUrl}/clusters`).pipe(r(t=>t.map(e=>({id:e.id,cluster_name:e.cluster_name,npa_count:e.npa_count,growth_percent:parseFloat(e.growth_percent)||0,intensity_percent:parseFloat(e.intensity_percent)||0}))))}getProspects(){return this.http.get(`${this.apiUrl}/prospects`).pipe(r(t=>t.map(e=>({id:e.id,name:e.name,theme:e.theme,probability:parseFloat(e.probability)||0,estimated_value:parseFloat(e.estimated_value)||0,value_currency:e.value_currency||"USD",status:e.status}))))}getRevenue(){return this.http.get(`${this.apiUrl}/revenue`).pipe(r(t=>t.map(e=>({id:e.id,title:e.title,estimated_revenue:parseFloat(e.estimated_revenue)||0,product_manager:e.product_manager,current_stage:e.current_stage,status:e.status}))))}getNpaPool(){return this.http.get(`${this.apiUrl}/npa-pool`)}parseNumeric(t){if(typeof t=="number")return t;if(!t)return 0;let e=String(t).replace(/[$,%]/g,"").replace(/M/gi,"").replace(/K/gi,"").replace(/Days/gi,"").trim();return parseFloat(e)||0}static \u0275fac=function(e){return new(e||a)};static \u0275prov=i({token:a,factory:a.\u0275fac,providedIn:"root"})};export{p as a};
