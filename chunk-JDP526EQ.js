import{Wb as C,Xb as I}from"./chunk-FLFKSUZI.js";import{Bb as v,Dc as z,Jb as _,Jc as w,Mb as r,Na as a,Nb as m,Ob as p,Pb as b,T as h,Y as c,Yb as x,ab as f,eb as u,pb as s,qb as i,rb as n,sb as d,vc as E,wc as y,xc as S}from"./chunk-IVDQKAZB.js";var g=class l{http=c(w);apiUrl="/api/evergreen";getAll(){return this.http.get(this.apiUrl)}getUtilization(t,e=30){return this.http.get(`${this.apiUrl}/${t}/utilization?days=${e}`)}recordUsage(t,e){return this.http.post(`${this.apiUrl}/${t}/record-usage`,e)}annualReview(t,e){return this.http.post(`${this.apiUrl}/${t}/annual-review`,e)}static \u0275fac=function(e){return new(e||l)};static \u0275prov=h({token:l,factory:l.\u0275fac,providedIn:"root"})};var U=(l,t,e)=>({"bg-emerald-500":l,"bg-amber-500":t,"bg-red-500":e}),O=(l,t,e)=>({"text-emerald-600":l,"text-amber-600":t,"text-red-600":e}),F=(l,t,e)=>({"bg-emerald-50 text-emerald-700 border-emerald-200":l,"bg-amber-50 text-amber-700 border-amber-200":t,"bg-red-50 text-red-700 border-red-200":e});function M(l,t){if(l&1&&(i(0,"div",32),r(1),n()),l&2){let e=v();a(),p(" ",e.breachedCount," Over Limit ")}}function P(l,t){if(l&1&&(i(0,"tr",33)(1,"td",34)(2,"div",35),r(3),n(),i(4,"div",36),r(5),n()(),i(6,"td",37),r(7),n(),i(8,"td",38),r(9),n(),i(10,"td",38),r(11),n(),i(12,"td",34)(13,"div",39)(14,"div",40),d(15,"div",41),n(),i(16,"span",42),r(17),n()()(),i(18,"td",43)(19,"span",44),r(20),n()(),i(21,"td",45),r(22),n()()),l&2){let e=t.$implicit,o=v();a(3),m(e.title),a(2),m(e.id),a(2),m(e.product_category||"N/A"),a(2),b(" ",e.currency," ",o.formatAmount(e.approved_limit)," "),a(2),b(" ",e.currency," ",o.formatAmount(e.volume_30d)," "),a(4),_("width",o.Math.min(e.utilization_pct,100),"%"),s("ngClass",x(15,U,e.utilization_pct<60,e.utilization_pct>=60&&e.utilization_pct<80,e.utilization_pct>=80)),a(),s("ngClass",x(19,O,e.utilization_pct<60,e.utilization_pct>=60&&e.utilization_pct<80,e.utilization_pct>=80)),a(),p("",e.utilization_pct,"%"),a(2),s("ngClass",x(23,F,e.utilization_pct<60,e.utilization_pct>=60&&e.utilization_pct<80,e.utilization_pct>=80)),a(),p(" ",e.utilization_pct>=100?"BREACHED":e.utilization_pct>=80?"HIGH":e.utilization_pct>=60?"MODERATE":"HEALTHY"," "),a(2),m(o.formatDate(e.last_metric_date))}}function L(l,t){l&1&&(i(0,"div",46),d(1,"lucide-icon",47),i(2,"h3",48),r(3,"No Evergreen products"),n(),i(4,"p",49),r(5,"No products are currently on the Evergreen track."),n()())}var D=class l{evergreenService=c(g);Math=Math;products=[];get avgUtilization(){return this.products.length===0?0:Math.round(this.products.reduce((t,e)=>t+e.utilization_pct,0)/this.products.length)}get highUtilCount(){return this.products.filter(t=>t.utilization_pct>=80).length}get breachedCount(){return this.products.filter(t=>t.utilization_pct>=100).length}ngOnInit(){this.loadData()}loadData(){this.evergreenService.getAll().subscribe({next:t=>this.products=t,error:t=>console.error("[EVERGREEN] Load failed",t)})}formatAmount(t){return t?t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(0)+"K":String(t):"0"}formatDate(t){return t?new Date(t).toLocaleDateString():"-"}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=f({type:l,selectors:[["app-evergreen-dashboard"]],decls:69,vars:8,consts:[[1,"h-full","flex","flex-col","bg-slate-50","font-sans","text-slate-900"],[1,"flex-none","bg-white","border-b","border-slate-200","px-8","py-5","flex","items-center","justify-between","shadow-sm"],[1,"text-2xl","font-bold","text-slate-900","tracking-tight","flex","items-center","gap-3"],["name","refresh-cw",1,"w-6","h-6","text-emerald-600"],[1,"text-sm","text-slate-500","mt-1"],[1,"flex","items-center","gap-3"],["class","bg-red-50 text-red-700 px-3 py-1 rounded-full text-xs font-bold border border-red-100",4,"ngIf"],[1,"bg-emerald-50","text-emerald-700","px-3","py-1","rounded-full","text-xs","font-bold","border","border-emerald-100"],[1,"flex-none","bg-white","border-b","border-slate-200","px-8","py-4"],[1,"grid","grid-cols-4","gap-4","max-w-4xl"],[1,"flex","items-center","gap-3","px-4","py-3","bg-slate-50","rounded-lg","border","border-slate-100"],[1,"p-2","bg-emerald-50","text-emerald-600","rounded-lg"],["name","layers",1,"w-4","h-4"],[1,"text-xl","font-bold","text-slate-900"],[1,"text-[10px]","font-bold","text-slate-400","uppercase"],[1,"p-2","bg-blue-50","text-blue-600","rounded-lg"],["name","bar-chart-3",1,"w-4","h-4"],[1,"p-2","bg-amber-50","text-amber-600","rounded-lg"],["name","alert-triangle",1,"w-4","h-4"],[1,"p-2","bg-red-50","text-red-600","rounded-lg"],["name","shield-alert",1,"w-4","h-4"],[1,"flex-1","overflow-auto","p-8"],[1,"max-w-6xl","mx-auto"],[1,"bg-white","rounded-xl","border","border-slate-200","shadow-sm","overflow-hidden"],[1,"w-full","text-left","text-xs"],[1,"bg-slate-50","border-b","border-slate-200","text-slate-500","uppercase","tracking-wider","font-semibold"],[1,"px-6","py-3"],[1,"px-6","py-3","text-right"],[1,"px-6","py-3","text-center"],[1,"divide-y","divide-slate-100"],["class","hover:bg-slate-50 transition-colors",4,"ngFor","ngForOf"],["class","text-center py-20",4,"ngIf"],[1,"bg-red-50","text-red-700","px-3","py-1","rounded-full","text-xs","font-bold","border","border-red-100"],[1,"hover:bg-slate-50","transition-colors"],[1,"px-6","py-4"],[1,"font-bold","text-slate-900","text-sm"],[1,"text-[10px]","text-slate-400","font-mono","mt-0.5"],[1,"px-6","py-4","text-slate-600"],[1,"px-6","py-4","text-right","font-mono","text-slate-700"],[1,"flex","items-center","gap-2"],[1,"flex-1","h-2","bg-slate-100","rounded-full","overflow-hidden","max-w-[100px]"],[1,"h-full","rounded-full","transition-all",3,"ngClass"],[1,"text-[11px]","font-bold","w-10","text-right",3,"ngClass"],[1,"px-6","py-4","text-center"],[1,"px-2","py-0.5","rounded-full","text-[10px]","font-bold","border",3,"ngClass"],[1,"px-6","py-4","text-slate-400","text-[11px]"],[1,"text-center","py-20"],["name","refresh-cw",1,"w-12","h-12","text-slate-300","mx-auto","mb-4"],[1,"text-lg","font-medium","text-slate-900"],[1,"text-slate-500","mt-2"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),d(4,"lucide-icon",3),r(5," Evergreen Products "),n(),i(6,"p",4),r(7,"Pre-approved products with same-day trading under approved limits."),n()(),i(8,"div",5),u(9,M,2,1,"div",6),i(10,"div",7),r(11),n()()(),i(12,"div",8)(13,"div",9)(14,"div",10)(15,"div",11),d(16,"lucide-icon",12),n(),i(17,"div")(18,"div",13),r(19),n(),i(20,"div",14),r(21,"Total Active"),n()()(),i(22,"div",10)(23,"div",15),d(24,"lucide-icon",16),n(),i(25,"div")(26,"div",13),r(27),n(),i(28,"div",14),r(29,"Avg Utilization"),n()()(),i(30,"div",10)(31,"div",17),d(32,"lucide-icon",18),n(),i(33,"div")(34,"div",13),r(35),n(),i(36,"div",14),r(37,">80% Utilized"),n()()(),i(38,"div",10)(39,"div",19),d(40,"lucide-icon",20),n(),i(41,"div")(42,"div",13),r(43),n(),i(44,"div",14),r(45,"Limit Breaches"),n()()()()(),i(46,"div",21)(47,"div",22)(48,"div",23)(49,"table",24)(50,"thead",25)(51,"tr")(52,"th",26),r(53,"Product"),n(),i(54,"th",26),r(55,"Category"),n(),i(56,"th",27),r(57,"Approved Limit"),n(),i(58,"th",27),r(59,"30d Volume"),n(),i(60,"th",26),r(61,"Utilization"),n(),i(62,"th",28),r(63,"Status"),n(),i(64,"th",26),r(65,"Last Activity"),n()()(),i(66,"tbody",29),u(67,P,23,27,"tr",30),n()(),u(68,L,6,0,"div",31),n()()()()),e&2&&(a(9),s("ngIf",o.breachedCount>0),a(2),p(" ",o.products.length," Active "),a(8),m(o.products.length),a(8),p("",o.avgUtilization,"%"),a(8),m(o.highUtilCount),a(8),m(o.breachedCount),a(24),s("ngForOf",o.products),a(),s("ngIf",o.products.length===0))},dependencies:[z,E,y,S,I,C],styles:["[_nghost-%COMP%]{display:block;height:100%}"]})};export{D as a};
